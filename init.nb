(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52636,       1151]
NotebookOptionsPosition[     52202,       1131]
NotebookOutlinePosition[     52549,       1146]
CellTagsIndexPosition[     52506,       1143]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.658868967015094*^9, 3.6588689707373066`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "libraries", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<ComputationalGeometry`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "locations", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"absolutePath", " ", "=", " ", "\"\<insert path\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Example", ":", "absolutePath"}], " ", "=", " ", 
      "\"\<C:\\\\disco-bitumen-adhesion\\\\\>\""}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"folder", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"absolutePath", "<>", "\"\<samples\>\""}], "}"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"destination", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"absolutePath", "<>", "\"\<results\>\""}], "}"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"type", "=", "\"\<jpg\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"type2", "=", "\"\<png\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sample", "=", "\"\<001\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"camera", "=", "\"\<Samsung S6 32GB, ISO200, 16MP\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "who", "=", 
     "\"\<generated by Dariusz Bro\:017cyna using DISCO 2015\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "variables", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TVsize", " ", "=", " ", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Debuggersize", "=", "500"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6588687008108673`*^9, 3.6588687181208577`*^9}, 
   3.6588687875768304`*^9, {3.6588689441817875`*^9, 3.6588689556684446`*^9}, {
   3.6588690174519787`*^9, 3.658869035464009*^9}, {3.6588691394349556`*^9, 
   3.6588691396179657`*^9}, {3.658869375859478*^9, 3.658869376626522*^9}, {
   3.6588694296055527`*^9, 3.6588694299945745`*^9}, {3.6588695870515575`*^9, 
   3.658869587369576*^9}, {3.658869662549876*^9, 3.658869662691884*^9}, {
   3.6588697124877324`*^9, 3.65886971261874*^9}, {3.658876411152874*^9, 
   3.658876426902775*^9}, {3.6588764792647696`*^9, 3.658876479749798*^9}, {
   3.658876611744347*^9, 3.6588766144235*^9}, {3.6588767170193686`*^9, 
   3.658876717268383*^9}, {3.6589114211210656`*^9, 3.6589114212980757`*^9}, {
   3.6589114572661333`*^9, 3.658911500483605*^9}, {3.658911926311352*^9, 
   3.658911955161395*^9}, {3.6589233318281364`*^9, 3.6589233347181406`*^9}, 
   3.658923644776638*^9, {3.658936149959836*^9, 3.658936150109836*^9}, {
   3.6589364189412127`*^9, 3.6589364518912587`*^9}, {3.6589365216913567`*^9, 
   3.658936550411398*^9}, {3.6589368339517946`*^9, 3.658936834171795*^9}, {
   3.6589402829216256`*^9, 3.658940295961644*^9}, {3.658940422351821*^9, 
   3.658940422631821*^9}, {3.6589405917560606`*^9, 3.6589405918760605`*^9}, {
   3.658941181946887*^9, 3.658941182816888*^9}, {3.65894141180921*^9, 
   3.6589414119692097`*^9}, {3.658941868677888*^9, 3.6589418687738934`*^9}, {
   3.65894295077378*^9, 3.658942972648031*^9}, {3.6589430727277555`*^9, 
   3.6589430728777637`*^9}, {3.6589440659495645`*^9, 3.658944066239581*^9}, {
   3.6589449351992826`*^9, 3.6589449377274275`*^9}, {3.6589494121103477`*^9, 
   3.6589494123773623`*^9}, {3.6589499767046404`*^9, 3.6589499768286476`*^9}, 
   3.6589501976132755`*^9, {3.6589503179361577`*^9, 3.658950318204173*^9}, {
   3.6589546078210583`*^9, 3.658954635531097*^9}, {3.658954748611255*^9, 
   3.658954789631313*^9}, {3.6589594258205256`*^9, 3.658959447880556*^9}, {
   3.65895987802316*^9, 3.6589598828931665`*^9}, 3.658960889288581*^9, {
   3.6589634209251347`*^9, 3.658963422995137*^9}, {3.6590095650214777`*^9, 
   3.659009565151478*^9}, {3.6590098725359497`*^9, 3.65900987266595*^9}, {
   3.7170373087466974`*^9, 3.7170373198574286`*^9}, {3.717037497786002*^9, 
   3.7170375192882795`*^9}, {3.71703756818412*^9, 3.7170376524917417`*^9}, {
   3.717037729223641*^9, 3.717037729333144*^9}, {3.7170379526854177`*^9, 
   3.7170379532637863`*^9}, {3.717038035148034*^9, 3.7170380353044395`*^9}, {
   3.717038216089173*^9, 3.7170382210898533`*^9}, {3.717043639434642*^9, 
   3.7170436646734505`*^9}, {3.7170436950111876`*^9, 3.7170437200547047`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Procedures", "Section",
 CellChangeTimes->{{3.65886885155649*^9, 3.658868858503887*^9}, {
   3.658868934389228*^9, 3.6588689370453796`*^9}, 3.658869542192992*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "reads", " ", "the", " ", "image", " ", "and", " ", "resizes", " ", "it"}],
    "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Teleport", "[", "size_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"path", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "folder", "<>", "\"\<\\\\\>\"", "<>", "sample", "<>", "\"\<.\>\"", "<>",
            "type"}], "}"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"i1", "=", 
        RowBox[{"ImageResize", "[", 
         RowBox[{
          RowBox[{"Import", "[", "path", "]"}], ",", "size"}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "normalizes", " ", "the", " ", "brightness", " ", "gradiened", " ", "for",
      " ", "a", " ", "specifig", " ", "angle", " ", "of", " ", "background", 
     " ", "and", " ", "brightness"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HSB", "[", 
     RowBox[{
     "img_", ",", "colorstart_", ",", "colorfinish_", ",", "bright_"}], "]"}],
     ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"blue", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"200", "/", "360"}], ",", "0.9", ",", "1"}], "}"}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ib", "=", 
        RowBox[{"ColorConvert", "[", 
         RowBox[{"img", ",", "\"\<HSB\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ii", "=", 
        RowBox[{"ImageApply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"colorstart", "/", "360"}], ")"}], "<", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", 
               RowBox[{"(", 
                RowBox[{"colorfinish", "/", "360"}], ")"}]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ">", "bright"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], ",", 
          "ib"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ic", "=", 
        RowBox[{"ImageApply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"colorstart", "/", "360"}], ")"}], "<", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", 
               RowBox[{"(", 
                RowBox[{"colorfinish", "/", "360"}], ")"}]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ">", "bright"}]}], ",", 
             "blue", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], ",", 
          "ib"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ic", "=", 
        RowBox[{"ColorConvert", "[", 
         RowBox[{"ic", ",", "\"\<RGB\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i1", "=", 
        RowBox[{"ColorConvert", "[", 
         RowBox[{"ii", ",", "\"\<RGB\>\""}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "cleans", " ", "all", " ", "variables", " ", "and", " ", "definitions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Purge", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"cleaning", " ", "all", " ", "the", " ", "variables"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "crops", " ", "a", " ", "centered", " ", "rectangle", " ", "removing", 
     " ", "the", " ", "sample", " ", "code"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RemoveCode", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"height", ",", "scale"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"height", "=", 
        RowBox[{
         RowBox[{"ImageDimensions", "[", "img", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"i1", "=", 
        RowBox[{"ImageCrop", "[", 
         RowBox[{"img", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"height", "*", "scale"}], ",", 
            RowBox[{"height", "*", "scale"}]}], "}"}], ",", "Center"}], 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "custom", " ", "show", " ", "with", " ", "size", " ", "defined", " ", 
     "by", " ", "global", " ", "TVsize", " ", "variable"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TV", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"img", ",", 
        RowBox[{"ImageSize", "\[Rule]", "TVsize"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "custom", " ", "show", " ", "with", " ", "size", " ", "defined", " ", 
     "by", " ", "local", " ", "screen", " ", "variable"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Crt", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"img", ",", 
        RowBox[{"ImageSize", "\[Rule]", "screen"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "detects", " ", "the", " ", "aggregate", " ", "particles", " ", "DEBUG", 
     " ", "MODULE"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rocks", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", "img", "]"}], ",", 
                "\"\<Grayscale\>\""}], "]"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"lower", ",", "upper"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"SetAlphaChannel", "[", 
             RowBox[{"i5", ",", "alfa"}], "]"}]}], "}"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Debuggersize", ",", "Debuggersize"}], "}"}]}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lower", ",", "0", ",", "\"\<Lower limit\>\""}], "}"}], 
          ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"upper", ",", "0.852", ",", "\"\<Upper limit\>\""}], "}"}],
           ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"alfa", ",", "0", ",", "\"\<Alfa\>\""}], "}"}], ",", "0", 
          ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\>\"", ",", "\"\<\>\"", ",", 
           "\"\<Establishes the detection levels for particle borders\>\""}], 
          "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "detects", " ", "the", " ", "areas", " ", "where", " ", "the", " ", 
     "aggregate", " ", "has", " ", "been", " ", "washed", " ", "out", " ", 
     "DEBUG", " ", "MODULE"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Wash", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ColorNegate", "[", 
             RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ImageAdjust", "[", "img", "]"}], ",", 
                 "\"\<Grayscale\>\""}], "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"lower", ",", "upper"}], "}"}]}], "]"}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"SetAlphaChannel", "[", 
             RowBox[{"img", ",", "alfa"}], "]"}]}], "}"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Debuggersize", ",", "Debuggersize"}], "}"}]}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lower", ",", "0.142", ",", "\"\<Lower limit\>\""}], "}"}],
           ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"upper", ",", "0.878", ",", "\"\<Upper limit\>\""}], "}"}],
           ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"alfa", ",", "0", ",", "\"\<Alfa\>\""}], "}"}], ",", "0", 
          ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\>\"", ",", "\"\<\>\"", ",", 
           "\"\<Establishes the detection levels for washed aggregate\>\""}], 
          "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cutter", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"GeodesicClosing", "[", 
               RowBox[{"(*", 
                RowBox[{"removing", " ", "noise"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Blur", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", "i1", "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<Grayscale\>\""}], "]"}], 
                  "\[IndentingNewLine]", ",", "3"}], "]"}], 
                "\[IndentingNewLine]", ",", "10"}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"lower", ",", "upper"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"SetAlphaChannel", "[", 
             RowBox[{"img", ",", "alfa"}], "]"}]}], "}"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Debuggersize", ",", "Debuggersize"}], "}"}]}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lower", ",", "0.77", ",", "\"\<Lower limit\>\""}], "}"}], 
          ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"upper", ",", "1", ",", "\"\<Upper limit\>\""}], "}"}], 
          ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"alfa", ",", "0", ",", "\"\<Alfa\>\""}], "}"}], ",", "0", 
          ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<Marker Detection\>\""}], 
          "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "overlays", " ", "results", " ", "with", " ", "chromakeyed", " ", 
     "image"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kimchi", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"result", "\[IndentingNewLine]", ",", 
            RowBox[{"SetAlphaChannel", "[", 
             RowBox[{"i5", ",", "alfa"}], "]"}]}], "}"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Debuggersize", ",", "Debuggersize"}], "}"}]}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"alfa", ",", "0", ",", "\"\<Alfa\>\""}], "}"}], ",", "0", 
          ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<Debugger of results\>\""}], 
          "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"detects", " ", "the", " ", "aggregate", " ", "particles"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetRocks", "[", 
     RowBox[{"img_", ",", "lower_", ",", "upper_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"rocks", "=", 
       RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ImageAdjust", "[", "img", "]"}], ",", 
           "\"\<Grayscale\>\""}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"lower", ",", "upper"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "detects", " ", "the", " ", "areas", " ", "where", " ", "the", " ", 
     "aggregate", " ", "has", " ", "been", " ", "washed", " ", "out"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetWash", "[", 
     RowBox[{"img_", ",", "lower_", ",", "upper_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"wash", "=", 
       RowBox[{"ColorNegate", "[", 
        RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ImageAdjust", "[", "img", "]"}], ",", 
            "\"\<Grayscale\>\""}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"lower", ",", "upper"}], "}"}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "detects", " ", "the", " ", "edge", " ", "of", " ", "aggregate", " ", 
     "particles"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetDMZ", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dmz", "=", 
        RowBox[{"ColorNegate", "[", "\[IndentingNewLine]", 
         RowBox[{"EdgeDetect", "[", "\[IndentingNewLine]", 
          RowBox[{"GeodesicOpening", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ColorNegate", "[", "\[IndentingNewLine]", 
             RowBox[{"DeleteSmallComponents", "\[IndentingNewLine]", "[", 
              RowBox[{"img", " ", 
               RowBox[{"(*", "rocks", "*)"}], "\[IndentingNewLine]", ",", 
               "10"}], "]"}], "]"}], "\[IndentingNewLine]", ",", "1"}], "]"}],
           "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetBitumen", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bitumen", "=", 
        RowBox[{"ColorNegate", "[", 
         RowBox[{"ImageMultiply", "[", 
          RowBox[{"rocks", ",", "wash"}], "]"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "detects", " ", "the", " ", "black", " ", "tape", " ", "markers", " ", 
     "and", " ", "limits", " ", "the", " ", "number", " ", "of", " ", 
     "points"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetCutter", "[", 
     RowBox[{"img_", ",", "lower_", ",", "upper_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i2", "=", 
        RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GeodesicClosing", "[", 
           RowBox[{"(*", 
            RowBox[{"removing", " ", "noise"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Blur", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", "i1", "]"}], 
                "\[IndentingNewLine]", ",", "\"\<Grayscale\>\""}], "]"}], 
              "\[IndentingNewLine]", ",", "3"}], "]"}], "\[IndentingNewLine]",
             ",", "10"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"lower", ",", "upper"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"ImageCorners", "[", "i2", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"Part", "[", 
         RowBox[{"points", ",", 
          RowBox[{"ConvexHull", "[", "points", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{"ImageTrim", "[", 
         RowBox[{"img", ",", "points"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"HighlightImage", "[", 
         RowBox[{"i2", ",", "points"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "removes", " ", "the", " ", "black", " ", "tape", " ", "dimensions", " ", 
     "markers"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MarkerRemove", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dimR", "=", "160"}], ",", 
        RowBox[{"markR", "=", "15"}], ",", 
        RowBox[{"pad", "=", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ImageDimensions", "[", "img", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"ImageDimensions", "[", "img", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dimH", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"dim", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mark", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"dim", "*", 
          RowBox[{"markR", "/", "dimR"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"markH", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"mark", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"points2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mark", "+", "pad"}], ",", 
            RowBox[{"mark", "+", "pad"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dim", "-", "mark", "-", "pad"}], ",", 
            RowBox[{"mark", "+", "pad"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mark", "+", "pad"}], ",", 
            RowBox[{"dim", "-", "mark", "-", "pad"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dim", "-", "mark", "-", "pad"}], ",", 
            RowBox[{"dim", "-", "mark", "-", "pad"}]}], "}"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"i5", "=", 
        RowBox[{"ImageTrim", "[", 
         RowBox[{"img", ",", "points2"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"creates", " ", "a", " ", "nice", " ", "visualisation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PR", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"parts", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ColorReplace", "[", 
           RowBox[{"wash", ",", 
            RowBox[{"Black", "\[Rule]", "White"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorReplace", "[", 
           RowBox[{"rocks", ",", 
            RowBox[{"Black", "\[Rule]", 
             RowBox[{"GrayLevel", "[", "0.9", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorReplace", "[", 
           RowBox[{"bitumen", ",", 
            RowBox[{"Black", "\[Rule]", "Red"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "dmz"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "dmz"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "adds", " ", "a", " ", "frame", " ", "to", " ", "an", " ", "image"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Border", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"ImagePad", "[", 
        RowBox[{"img", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "Black"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cerder", "[", "img_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"ImagePad", "[", 
        RowBox[{"img", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "Black"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Makoli", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TV", "[", 
          RowBox[{"Border", "[", "result", "]"}], "]"}], ",", 
         RowBox[{"TV", "[", 
          RowBox[{"Border", "[", "wash", "]"}], "]"}]}], "}"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Crt", "[", "wash", "]"}], ",", 
         RowBox[{"Crt", "[", "bitumen", "]"}], ",", 
         RowBox[{"Crt", "[", "rocks", "]"}]}], "}"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"washcount", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ImageScan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "0"}], ",", 
            RowBox[{"washcount", "++"}]}], "]"}], "&"}], ",", "wash"}], "]"}],
        ";", 
       RowBox[{"(*", 
        RowBox[{"washed", " ", "aggregate"}], "*)"}], "\[IndentingNewLine]", 
       "washcount", ";", "\[IndentingNewLine]", 
       RowBox[{"bitumencount", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ImageScan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "0"}], ",", 
            RowBox[{"bitumencount", "++"}]}], "]"}], "&"}], ",", "bitumen"}], 
        "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"aggregate", " ", "covered", " ", "with", " ", "bitumen"}], 
        "*)"}], "\[IndentingNewLine]", "bitumencount", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fraction", "=", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"bitumencount", "/", 
            RowBox[{"(", 
             RowBox[{"bitumencount", "+", "washcount"}], ")"}]}], ",", "4"}], 
          "]"}], "*", "100"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"text1", "=", 
        RowBox[{
        "\"\<Sample [\>\"", "<>", "sample", "<>", 
         "\"\<] covered with bitumen in \>\"", "<>", 
         RowBox[{"ToString", "[", "fraction", "]"}], "<>", "\"\<%\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"fimage1", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Border", "[", "result", "]"}], ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"text1", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Vernada\>\""}], ",", 
                RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"5", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], "}"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"text2", "=", 
        RowBox[{
        "\"\<Sample [\>\"", "<>", "sample", "<>", 
         "\"\<] covered with bitumen in \>\"", "<>", 
         RowBox[{"ToString", "[", "fraction", "]"}], "<>", 
         "\"\<%; pixel count covered/total \>\"", "<>", 
         RowBox[{"ToString", "[", "bitumencount", "]"}], "<>", "\"\</\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"bitumencount", "+", "washcount"}], "]"}], "<>", 
         "\"\<; used camera \>\"", "<>", "camera", "<>", "\"\<; \>\"", "<>", 
         "who"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tempresult", "=", 
        RowBox[{"ImagePad", "[", 
         RowBox[{"result", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "walkaround", " ", "of", " ", "the", " ", "framing", " ", "bug"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fimage2", "=", 
        RowBox[{"ImagePad", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ImagePad", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ImagePad", "[", 
                RowBox[{
                 RowBox[{"ImagePad", "[", 
                  RowBox[{
                   RowBox[{"ImageCollage", "[", 
                    RowBox[{"{", 
                    RowBox[{"tempresult", ",", "comp"}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"20", ",", "0"}], "}"}]}], "}"}], ",", "White"}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"text2", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Vernada\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], "}"}], 
                "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"COM", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GetCutter", "[", 
        RowBox[{"ic", ",", "0.77", ",", "1"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MarkerRemove", "[", "i4", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"comp", "=", "i5"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Stasis", "[", 
     RowBox[{"name_", ",", "mark_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"path2", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "destination", "<>", "\"\<\\\\\>\"", "<>", "sample", "<>", "mark", 
           "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "fraction", "]"}], "<>", "\"\<.\>\"", "<>",
            "type2"}], "}"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"path2", ",", "name", ",", "type2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.657989549933821*^9, 3.657989664445983*^9}, {
   3.6579896964260273`*^9, 3.657989723776066*^9}, {3.6579897776361413`*^9, 
   3.6579898056661806`*^9}, {3.657989850986244*^9, 3.6579899449223814`*^9}, {
   3.6579899785724287`*^9, 3.6579902018847494`*^9}, {3.6579902716348467`*^9, 
   3.6579902823548613`*^9}, {3.6579903227349186`*^9, 
   3.6579903991950254`*^9}, {3.6579910430059266`*^9, 
   3.6579910431459265`*^9}, {3.657991235037116*^9, 3.6579912651858406`*^9}, {
   3.6579913373689694`*^9, 3.657991345279422*^9}, {3.6579914442690835`*^9, 
   3.6579914520445285`*^9}, {3.6579987022132144`*^9, 3.657998772907258*^9}, {
   3.657998806920203*^9, 3.657998926028016*^9}, {3.6579989644572144`*^9, 
   3.6579989887346025`*^9}, {3.657999020674429*^9, 3.6579990577835517`*^9}, {
   3.6579991334038773`*^9, 3.657999155117119*^9}, {3.6579991957794447`*^9, 
   3.6579992805592937`*^9}, {3.6579993294210887`*^9, 
   3.6579994247025385`*^9}, {3.6579994896172514`*^9, 
   3.6579997486540675`*^9}, {3.6579997809439144`*^9, 
   3.6579999064970956`*^9}, {3.657999966705539*^9, 3.6580000639911036`*^9}, {
   3.6580000961359425`*^9, 3.6580001242385497`*^9}, {3.658000203939108*^9, 
   3.658000271710984*^9}, {3.6580003127853336`*^9, 3.658000390393773*^9}, {
   3.6580004207045064`*^9, 3.658000497097876*^9}, {3.6582520465127077`*^9, 
   3.658252077552483*^9}, {3.658252117121746*^9, 3.6582521694737406`*^9}, {
   3.6582522257649603`*^9, 3.6582523226255007`*^9}, {3.658252376182564*^9, 
   3.658252410696538*^9}, {3.6582526775067987`*^9, 3.6582526807599845`*^9}, {
   3.6582527193681927`*^9, 3.65825275516724*^9}, {3.6582528512097335`*^9, 
   3.6582528523668003`*^9}, {3.658253309279934*^9, 3.6582533752567077`*^9}, {
   3.6582534393673744`*^9, 3.6582534399634085`*^9}, {3.6582558600268283`*^9, 
   3.658255863959053*^9}, {3.658256034909831*^9, 3.6582560646955347`*^9}, {
   3.658256120025699*^9, 3.658256147169252*^9}, {3.658257851504734*^9, 
   3.6582578529628177`*^9}, {3.6582578965793123`*^9, 
   3.6582579489753094`*^9}, {3.6582580295839195`*^9, 
   3.6582581070443506`*^9}, {3.6582592828066*^9, 3.658259302631734*^9}, {
   3.6582594070907087`*^9, 3.6582594116509695`*^9}, {3.6582594725644536`*^9, 
   3.6582594995909996`*^9}, {3.6582595310938015`*^9, 
   3.6582595953844786`*^9}, {3.658259693771106*^9, 3.6582597403027673`*^9}, {
   3.658260288700134*^9, 3.6582603050140667`*^9}, {3.6582604153583784`*^9, 
   3.6582604322723455`*^9}, {3.658260489398613*^9, 3.6582606168769045`*^9}, {
   3.658260769519635*^9, 3.658260809853942*^9}, {3.6582608466510468`*^9, 
   3.658261045162401*^9}, {3.6582610812654657`*^9, 3.658261138424735*^9}, {
   3.6582611692724996`*^9, 3.6582611709615965`*^9}, {3.658261209582805*^9, 
   3.6582612296419525`*^9}, {3.658261271088323*^9, 3.658261305635299*^9}, {
   3.6582613389162025`*^9, 3.6582614083271728`*^9}, {3.658261440572017*^9, 
   3.6582614822624016`*^9}, {3.6582615224026976`*^9, 
   3.6582615225557065`*^9}, {3.6582615569176717`*^9, 3.658261598928075*^9}, {
   3.6582616567713833`*^9, 3.6582617033960495`*^9}, {3.658261814522406*^9, 
   3.658261893342914*^9}, {3.658261935982353*^9, 3.6582619808869214`*^9}, {
   3.6582620465206757`*^9, 3.658262277589892*^9}, {3.658262380603784*^9, 
   3.658262480933522*^9}, {3.6582625256680813`*^9, 3.6582625350976205`*^9}, {
   3.6582625753679237`*^9, 3.658262596294121*^9}, {3.6582626372984657`*^9, 
   3.658262639657601*^9}, {3.658262685343214*^9, 3.658262732147891*^9}, {
   3.6582628311275525`*^9, 3.65826283143357*^9}, {3.658337409434329*^9, 
   3.6583374279803896`*^9}, {3.6583374600122213`*^9, 
   3.6583375695094843`*^9}, {3.6583377172079325`*^9, 3.658337730383686*^9}, {
   3.65833777416019*^9, 3.6583378166146183`*^9}, {3.6583378559248667`*^9, 
   3.6583378578069744`*^9}, {3.658337949533221*^9, 3.6583379698073807`*^9}, {
   3.6583381929361424`*^9, 3.6583382198976846`*^9}, 3.658338274229792*^9, {
   3.658338597325272*^9, 3.6583386035756297`*^9}, 3.6583386771288366`*^9, {
   3.6583388802424545`*^9, 3.6583392176537533`*^9}, {3.658339451753143*^9, 
   3.658339820584239*^9}, {3.658339879371601*^9, 3.6583400988701553`*^9}, {
   3.6583401306159716`*^9, 3.6583401678401003`*^9}, {3.6583402072823563`*^9, 
   3.65834020856743*^9}, {3.6583403391098967`*^9, 3.6583403435091486`*^9}, {
   3.658340417750395*^9, 3.658340418417433*^9}, {3.658340464317058*^9, 
   3.658340500575132*^9}, 3.658340531580905*^9, {3.658340604264063*^9, 
   3.6583406621723747`*^9}, {3.658340699186492*^9, 3.658340699517511*^9}, {
   3.658340738569744*^9, 3.658340757933852*^9}, {3.658340807640695*^9, 
   3.6583408123379636`*^9}, {3.658340866262048*^9, 3.658340911466634*^9}, {
   3.658342267090171*^9, 3.658342288296384*^9}, {3.6583423224573374`*^9, 
   3.658342376455426*^9}, {3.6583424138425646`*^9, 3.658342522820798*^9}, {
   3.6583427816946044`*^9, 3.6583427990185957`*^9}, {3.658344058924658*^9, 
   3.6583440718013945`*^9}, 3.6583444877331843`*^9, {3.658344530471629*^9, 
   3.658344550162755*^9}, {3.6583449591831493`*^9, 3.6583449757220955`*^9}, {
   3.658345102357339*^9, 3.658345102438343*^9}, 3.658345137849369*^9, 
   3.6583459162268896`*^9, 3.6583459928912745`*^9, {3.6583498353140483`*^9, 
   3.658349950436633*^9}, {3.6583506429862447`*^9, 3.6583507114491606`*^9}, {
   3.6583507842723255`*^9, 3.658350784444336*^9}, {3.658351485408428*^9, 
   3.6583514900476937`*^9}, {3.6583515792007933`*^9, 
   3.6583516083354597`*^9}, {3.6583517757570353`*^9, 
   3.6583517796932607`*^9}, {3.6583523801746063`*^9, 
   3.6583523803216143`*^9}, {3.6584442514552455`*^9, 3.658444439622776*^9}, {
   3.658444706821045*^9, 3.6584447075074463`*^9}, {3.6584447740415635`*^9, 
   3.658444775055565*^9}, {3.6584449062205954`*^9, 3.658444956639884*^9}, {
   3.658444996560354*^9, 3.658444998962758*^9}, {3.658445032424817*^9, 
   3.6584450451856394`*^9}, {3.6588609492444444`*^9, 
   3.6588610600910273`*^9}, {3.6588610903110695`*^9, 3.658861203911228*^9}, {
   3.658861265112314*^9, 3.658861280622336*^9}, 3.6588614539925785`*^9, {
   3.6588616130628014`*^9, 3.6588616281028223`*^9}, {3.658861677512892*^9, 
   3.6588616780128927`*^9}, {3.6588617974530597`*^9, 
   3.6588618080730743`*^9}, {3.6588618381631165`*^9, 
   3.6588618384631166`*^9}, {3.658861872713165*^9, 3.6588619132632217`*^9}, {
   3.6588619495732727`*^9, 3.6588619582432847`*^9}, {3.6588620566234226`*^9, 
   3.6588620567534227`*^9}, {3.6588642774048634`*^9, 
   3.6588643740273895`*^9}, {3.658864555282757*^9, 3.6588645834783697`*^9}, {
   3.658864629129981*^9, 3.6588647582933683`*^9}, {3.6588648779862146`*^9, 
   3.6588649637911224`*^9}, {3.658865019595314*^9, 3.658865019714321*^9}, {
   3.658865073522399*^9, 3.658865137867079*^9}, {3.6588652007286744`*^9, 
   3.658865253928717*^9}, {3.658865301791455*^9, 3.6588653638060017`*^9}, {
   3.6588656558207045`*^9, 3.6588656566377506`*^9}, {3.6588658016600456`*^9, 
   3.658865814291768*^9}, {3.6588659482774315`*^9, 3.658865953055705*^9}, {
   3.658866095356844*^9, 3.6588660981270027`*^9}, {3.658866159854533*^9, 
   3.6588661610115995`*^9}, {3.6588665598364105`*^9, 
   3.6588665605254507`*^9}, {3.6588665913892155`*^9, 3.65886659181424*^9}, 
   3.658866654003797*^9, {3.658866686433652*^9, 3.6588666865676594`*^9}, {
   3.6588667280920343`*^9, 3.6588667316382375`*^9}, 3.658867163957965*^9, {
   3.658867420232623*^9, 3.6588674650551863`*^9}, {3.658867752627635*^9, 
   3.6588677862305565`*^9}, {3.658867926700591*^9, 3.6588679286857047`*^9}, {
   3.6588679598254857`*^9, 3.658867974538327*^9}, {3.6588680393370333`*^9, 
   3.658868047863521*^9}, {3.658868091131996*^9, 3.6588681007425456`*^9}, {
   3.6588681892566085`*^9, 3.658868242419649*^9}, {3.6588683342199*^9, 
   3.658868334357908*^9}, {3.6588685106909933`*^9, 3.658868572361521*^9}, {
   3.6588686440846233`*^9, 3.658868695137543*^9}, {3.6588687522238083`*^9, 
   3.6588687790483427`*^9}, {3.658877259351388*^9, 3.658877265924764*^9}, {
   3.658877335733757*^9, 3.6588773382268996`*^9}, {3.658877961364257*^9, 
   3.6588779651862636`*^9}, {3.6588780264970846`*^9, 
   3.6588780294298897`*^9}, {3.658878167392029*^9, 3.6588781675395308`*^9}, {
   3.6589119926114473`*^9, 3.6589119953314514`*^9}, {3.6589131665230913`*^9, 
   3.6589131917031264`*^9}, {3.6589151424927006`*^9, 3.658915154012717*^9}, {
   3.6589152001227818`*^9, 3.6589152060127897`*^9}, {3.6589179608907146`*^9, 
   3.6589179693831997`*^9}, {3.6589221471321535`*^9, 3.658922195459918*^9}, {
   3.658922243173647*^9, 3.6589222507110777`*^9}, {3.6589225105209384`*^9, 
   3.6589225292130075`*^9}, {3.658922597003885*^9, 3.6589226704640865`*^9}, {
   3.6589227794543204`*^9, 3.6589227826225014`*^9}, {3.658923109522199*^9, 
   3.6589231164115934`*^9}, {3.65892340553824*^9, 3.658923424323266*^9}, {
   3.6589240675697584`*^9, 3.658924120959833*^9}, {3.6589255047862473`*^9, 
   3.6589255301436977`*^9}, {3.6589260223048477`*^9, 3.658926077893027*^9}, {
   3.658926186887261*^9, 3.65892620488029*^9}, {3.6589269579173613`*^9, 
   3.658927015402649*^9}, {3.6589272613097143`*^9, 3.6589272744774675`*^9}, 
   3.6589274397449207`*^9, {3.6589276357881336`*^9, 3.6589276406454115`*^9}, {
   3.658927674424343*^9, 3.658927727148359*^9}, {3.6589277666866207`*^9, 
   3.658927768005696*^9}, {3.6589278965800495`*^9, 3.6589278969450707`*^9}, {
   3.658928045172549*^9, 3.6589280464586225`*^9}, {3.6589340335670915`*^9, 
   3.658934148688676*^9}, {3.658934186184821*^9, 3.65893419193915*^9}, {
   3.658934508993284*^9, 3.658934513357534*^9}, {3.658934584902626*^9, 
   3.658934631617298*^9}, {3.6589346625920696`*^9, 3.658934670418517*^9}, {
   3.6589348927552342`*^9, 3.6589349231939754`*^9}, {3.658935013038114*^9, 
   3.6589350626169496`*^9}, {3.6589353166574802`*^9, 3.658935344580077*^9}, {
   3.65893569955138*^9, 3.6589357073298254`*^9}, {3.6589357975009828`*^9, 
   3.6589358416945105`*^9}, {3.658940308801662*^9, 3.6589403339916973`*^9}, {
   3.658940524155966*^9, 3.6589405663060246`*^9}, {3.6589406281861115`*^9, 
   3.658940631766116*^9}, {3.6589406859961925`*^9, 3.65894108427675*^9}, {
   3.658941130746815*^9, 3.658941174356876*^9}, {3.6589413070790634`*^9, 
   3.658941307519064*^9}, {3.658941367949148*^9, 3.6589413714691534`*^9}, {
   3.6589416579095545`*^9, 3.6589416580295544`*^9}, {3.658941730760999*^9, 
   3.6589418489687605`*^9}, {3.658942042949856*^9, 3.658942055533575*^9}, {
   3.6589421136639*^9, 3.6589421139819183`*^9}, 3.6589423645632505`*^9, {
   3.6589424883833327`*^9, 3.658942501919107*^9}, {3.6589427826831656`*^9, 
   3.6589427957869153`*^9}, {3.65894287891467*^9, 3.658942943147344*^9}, {
   3.658943147741046*^9, 3.6589431813129663`*^9}, {3.658943293359375*^9, 
   3.6589433429122095`*^9}, {3.658943413301235*^9, 3.6589435222434664`*^9}, {
   3.658943777524068*^9, 3.6589437997363377`*^9}, {3.658943838217539*^9, 
   3.658943932363924*^9}, {3.6589439881661158`*^9, 3.6589439894251876`*^9}, {
   3.6589444582680035`*^9, 3.658944501519478*^9}, {3.658947553501041*^9, 
   3.658947574143222*^9}, 3.6589476564689302`*^9, {3.658947688049737*^9, 
   3.6589477591678047`*^9}, {3.6589478156780367`*^9, 
   3.6589478725512896`*^9}, {3.6589479231501837`*^9, 3.658947981876543*^9}, {
   3.6589481154651833`*^9, 3.6589481646939993`*^9}, {3.658948232590883*^9, 
   3.658948232826896*^9}, {3.65894832468215*^9, 3.6589483392229815`*^9}, {
   3.65894839129296*^9, 3.6589484531014953`*^9}, {3.6589485919574375`*^9, 
   3.658948596049671*^9}, {3.6589486450364733`*^9, 3.6589486545910196`*^9}, {
   3.658948768127514*^9, 3.658948773780837*^9}, {3.6589488087108345`*^9, 
   3.658948838607545*^9}, {3.6589492616927443`*^9, 3.658949293503564*^9}, {
   3.6589499376124043`*^9, 3.658949998616894*^9}, {3.6589501909658957`*^9, 
   3.658950192008955*^9}, {3.6589502837011995`*^9, 3.658950305971473*^9}, {
   3.658950390519309*^9, 3.658950401862958*^9}, {3.6589505953960276`*^9, 
   3.6589506042595344`*^9}, 3.658950832954615*^9, 3.658950886637686*^9, {
   3.6589509184955077`*^9, 3.658950981174093*^9}, 3.658951273439809*^9, {
   3.6589516638681407`*^9, 3.658951664164158*^9}, {3.6589522186968746`*^9, 
   3.6589522197749367`*^9}, {3.6589522887448816`*^9, 
   3.6589522969003477`*^9}, {3.658952331595332*^9, 3.6589523448140883`*^9}, {
   3.6589530131678257`*^9, 3.658953039627863*^9}, {3.6589531508880186`*^9, 
   3.6589531988380857`*^9}, {3.6589534430084276`*^9, 3.658953464148457*^9}, {
   3.6589535973186436`*^9, 3.6589536189486732`*^9}, {3.658955506382316*^9, 
   3.6589555183323326`*^9}, {3.6589555794524183`*^9, 
   3.6589555949624405`*^9}, {3.6589557416126456`*^9, 
   3.6589557436226482`*^9}, {3.6589558625528145`*^9, 3.6589558806828403`*^9}, 
   3.658955915362889*^9, {3.658956004643014*^9, 3.6589560062430162`*^9}, {
   3.658956057437092*^9, 3.6589560655271034`*^9}, {3.6589561807672644`*^9, 
   3.6589562041672974`*^9}, {3.658956265667383*^9, 3.658956266497384*^9}, {
   3.658956359651517*^9, 3.658956363841523*^9}, 3.6589565673818083`*^9, 
   3.658956624471888*^9, {3.658957338382888*^9, 3.658957363602923*^9}, {
   3.658957402192977*^9, 3.658957402322977*^9}, 3.6589591592901525`*^9, 
   3.658959245220273*^9, {3.6589593148903704`*^9, 3.6589593208403788`*^9}, {
   3.658959359460433*^9, 3.6589593614204354`*^9}, {3.6589601212435007`*^9, 
   3.658960121583501*^9}, {3.658963568395341*^9, 3.658963568655341*^9}, {
   3.6589641281221323`*^9, 3.658964139692148*^9}, {3.65896455261434*^9, 
   3.658964577844375*^9}}]
}, Open  ]]
},
WindowSize->{1350, 686},
WindowMargins->{{-1740, Automatic}, {89, Automatic}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 101, 1, 63, "Section"],
Cell[684, 25, 4473, 82, 370, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5194, 112, 168, 2, 63, "Section"],
Cell[5365, 116, 46821, 1012, 6306, "Input"]
}, Open  ]]
}
]
*)

